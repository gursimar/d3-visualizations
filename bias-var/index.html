<!DOCTYPE html>
<meta charset="utf-8">

<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue_grey-blue.min.css" />
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<link rel="stylesheet" href="bower_components/intro.js/introjs.css"/>
<link rel="stylesheet" href="css/styles.css">

<body>
<div class="jumbotron text-center">
  <h2 class="jumbotext">Polynomial regression<font size="4">(<a style="color:#e7298a" target="_blank" href="https://en.wikipedia.org/wiki/Polynomial_regression">?</a>)</font> bias-variance tradeoff<font size="4">(<a style="color:#e7298a" target="_blank" href="https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff">?</a>)</font> playground</h2>
  <p class = "jumbotext">Choose a dataset, tinker with parameters and see how your model does on bias/ variance tradeoff!</p> 
</div>
<div class="container-fluid">
<div id="help" style="margin-top:-25px" align="right">
  <span  class="glyphicon glyphicon glyphicon-question-sign" aria-hidden="true"></span>
</div>

  <div style="margin-top:-20px" class="row">
    <div style="position:relative; left:60px;" class="col-sm-2" data-step="10" data-intro='Tinker with these parameters and see how bias/ variance tardeoff changes.'>
    	<div style="margin-bottom:30px; margin-top:20px;" data-step="1" data-intro='Start by choose a dataset here!'>
	    	<h4>DATASET</h4>
	    	<p style="font:15px;">Which dataset you want to use?</p>
	        <div class="dataset-list">
	          <div class="dataset" title="Circle">
	            <img id="DS_a" src="images/a.png" class="data-thumbnail selected"></canvas>
	          </div>
	          <div class="dataset" title="Exclusive or">
	            <img id="DS_b" src="images/b.png" class="data-thumbnail"></canvas>
	          </div>
	          <div class="dataset" title="Gaussian">
	            <img id="DS_c" src="images/c.png" class="data-thumbnail"></canvas>
	          </div>
	        </div>	    	

			<!--div class="btn-group">
			  <button type="button" id="data_1" class="btn btn-default">Linear</button>
			  <button type="button" id="data_2" class="btn btn-default">Cmplx</button>
			  <button type="button" id="data_3" class="btn btn-default">Cmplx</button>
			</div-->
    	</div>
    	<div data-step="5" data-intro='Similarly try different values of noise and concentration and observe how the regression model behaves. Again, you can use the zoom button to see the big picture.'>
	    	<div>
		    	<h4 id ="sample_text">Concentration (50)</h4>
			    	<p style="font:15px;">Amount of data to sample?</p>
		            <input id="sampledegree" class="mdl-slider mdl-js-slider" type="range" min="50" max="500" step="150" value="50" tabindex="0"> 
	    	</div>

	    	<div>
		    	<h4 id ="noise_text">Noise (200)</h4>
			    	<p style="font:15px;">How much noise?</p>
		            <input id="noisedegree" class="mdl-slider mdl-js-slider" type="range" min="200" max="1000" step="200" value="200" tabindex="0"> 
	    	</div>
    	</div>
    	<br>
    	<div style="margin-top:50px" data-step="3" data-intro='Choose what degree polynomial you want to fit the data. If your data is more complex, you should choose a high degree polynomial to correctly model it. However, keep in mind that high degree polynomials are prone to overfitting.'>
	    	<h4 id ="poly_text">POLYNOMIAL DEG (4)</h4>
		    	<p style="font:15px;">What degree basis to fit?</p>
	            <input id="polydegree" class="mdl-slider mdl-js-slider" type="range" min="1" max="4" step="1" value="4" tabindex="0"> 

			<!--div class="btn-group">
			  <button type="button" class="btn btn-default" onclick="learnDrawCurve(1);">1</button>
			  <button type="button" class="btn btn-default" onclick="learnDrawCurve(2);">2</button>
			  <button type="button" class="btn btn-default" onclick="learnDrawCurve(3);">3</button>
			  <button type="button" class="btn btn-default" onclick="learnDrawCurve(4);">4</button>
			  <button type="button" class="btn btn-default" onclick="learnDrawCurve(5);">5</button>
			  <button type="button" class="btn btn-default" onclick="learnDrawCurve(6);">6</button>
			</div-->

    	</div>
		<!--br><br><br>
    	<div>
	    	<h4>Bias/Variance</h4>
			<div class="btn-group">
			  <button type="button" class="btn btn-default" onclick="generateBiasVarData()">Go</button>
			</div>
    	</div-->

    </div>
    <div class="col-sm-5">
    	<div style="position:relative; left:50px;margin-top:25px;" id ="plot-1" data-step="2" data-intro='The sampled data is displayed in this scatter plot. Also, it fits a regression line with polynomial basis of degree (p).'>
    		<div style="position:absolute;top:250px; left:520px" data-step="4" data-intro='Hover on this button to see the performance of your model on data points not present in the traning set.'>
				<!--button type="button" class="btn btn-default" onclick="showBigPicture()">Big pic</button>
				<button type="button" class="btn btn-default" onclick="showActualPicture()">Actual pic</button-->
				<span id="zoom" class="glyphicon glyphicon-zoom-out" aria-hidden="true"></span>
			</div>
			<div  style="position:absolute;top:350px;left:80px;width:80%;text-align:justify;font-size:15px">
				The scatter plot at the top represents one instance of sampled data and regression line which fits it.
				The plots on the right (box and bar) is constructed by repeatedly sampling data and fitting regression lines. The box plot on the top-right shows the distribution of residuals. The bar chart on the right represents the bias and variance of residuals. Each bar/ box corresponds to a particular degree of the regression line (shown on the x-axis).<br><br>Steps:
				<ul style="font-size:14px;margin-top:10px">
					<li>Choose a dataset from the pane on the left.</li>
					<li>Analyze bias-variance tradeoff by changing data/ noise/ samples.</li>
					<li>Investigate different fits by changing the degree of the polynomial.</li>
					<li>Use the zoom-out symbol to see generalizability of your model</li>
				</ul>

			</div>

    	</div>
    </div>
    <div class="col-sm-5" data-step="7" data-intro='These graph are computed by repeatedly sampling data and fitting regression lines. Due to noise each time you might get a different model. These plots are obtained by computing stats on data obtained in multiple runs. Read discussion below for more details'>
    	<div style="position:relative; left:65px;" id ="plot-2" data-step="8" data-intro='This plot is obtained by plotting the distribution of residuals. Each bar corresponds to a different degree of polynomial. Various stats like median, quartiles are shown. Observe that as you increase the polynomial degree, the median of the bar goes down and the spread increases. These two signals roughly corresponds to bias and variance.'>
    	</div>
    	<br>
    	<div style="margin-top:-20px; margin-left:20px;" id ="plot-3" data-step="9" data-intro='Here we plot the actual bias and variance against the polynomial degree. Observe that as the polynomial degree increases, bias reduces and variance increases. Hence the tradeoff!!'>
    	</div>
    </div>
  </div>
  <br>
  <br>
  <div class="row">
    <div class="col-sm-3">
    </div>
    <div style="margin-left:-20px" class="col-sm-6">
      <h3>Discussion</h3>
      <h5 class="question">What is polynomial regression?</h5>
      <p class="answer">Linear regression is a technique for modeling a dependent variable (y) as a linear combination of one or more independent variables x<sup>(i)</sup>). Polynomial regression allows us to capture non-linear relationships between X and y using a change of basis (z<sup>(i)</sup>=f(x<sup>(i)</sup>)). In a nutshell, instead of a line, it allows us to fit a n<sup>th</sup> degree polynomial to the data. Read more [<a href="https://en.wikipedia.org/wiki/Polynomial_regression">link</a>].</p>
      <h5 class="question">What is the aim of this playground?</h5>
      <p class="answer">Tinker with different values of parameters like polynomial degree (p), noise, and amount of sampling. Each value of the parameters result in a slightly different model in the bias-variance tradeoff landscape. The aim is to demonstrate the fundamental tradeoff, and relate it with overfitting/ underfitting and generalization error.</p>
      <h5 class="question">What is the bias and variance? How do you compute it?</h5>
      <p class="answer">Imagine, we can rebuild different models by repeatedly sampling new data. Due to noise, we may end up with a slightly different model. The bias for particular prediction corresponds to the difference between its expected value and its true value. The variance corresponds to the spread of these predictions. Read more [<a href = "http://scott.fortmann-roe.com/docs/BiasVariance.html">link</a>]. We compute the bias and variance of the whole model by averaging bias and variance of all data points in the dataset.</p>
      <h5 class="question">What is bias-variance tradeoff?</h5>
      <p class="answer">The tradeoff is in the sense that when you tweak the model parameters (degree of polynomial in this case), a decrease in one type of error leads to increase in the other and vice versa.</p>
      <h5 class="question">Scatter plot; how to interpret it?</h5>
      <p class="answer">The scatter plot represents a single snapshot of the data (shown as blue dots). We fit an n<sup>th</sup> degree polynomial regression line to it (shown in pink).
      <br><br>You can observe the bias-variance tradeoff by observing different fits for the same dataset. Notice that you get quite different fit for a higher degree polynomial (high variance) while you get the same model for a low degree polynomial (low variance). On the other hand, a high degree polynomial closely fits more number of points, hence the bias is low. While a low degree polynomial does not have this expressivity leading to high bias.</p>
      <h5 class="question">Box plot; how to interpret it?</h5>
      <p class="answer">Box plot is generated by plotting the distribution of residuals (absolute difference between predictions of the model and its actual value). Each bar corresponds to a different degree of a polynomial. Notice, a bar close to bottom represents low residuals (on average). Hence, the bias of the model is low. On the other hand, the height of a bar gives an idea of the spread of residuals, giving us an estimate of variance. These two things roughly correspond to bias and variance of the model. Notice, as the model degree increases, the bars shifts downwards (low bias) and the height of bars increases (high variance).</p>
      <h5 class="question">Bar plot; how to interpret it?</h5>
      <p class="answer">The bar chart is generated by computing the bias and variance of the model. Each bar corresponds to bias and variance of the model for a particular degree of the polynomial. Notice as you go right (increase in polynomial degree), the bias of the model decreases and the variance increases. On the other hand, if we go left (model degree decreases), the bias of the model increases and the variance decreases.</p>
      <h5 class="question">But, why did not you plot the bull's eye diagram?</h5>
      <p class="answer">One of my colleague did it another playground [<a href="https://github.com/halldorbjarni/knn-viz">link</a>]. The bulls's eye visualization idiom (originally proposed here [<a href="http://scott.fortmann-roe.com/docs/BiasVariance.html">link</a>]) is intuitive but not very accurate. It can be misleading since both bias and variance are really an one-dimentional quantity. Read our project report for more details [<a href="https://github.com/gursimar/d3-visualizations/blob/master/bias-var/cpsc547%20final%20report.pdf">link</a>]. Also, feel free to suggest any changes by submitting a pull request here [<a href="https://github.com/gursimar/d3-visualizations/tree/master/bias-var">link</a>]</p>
      <br><br>
    </div>
    <div class="col-sm-3">
    </div>
  </div>
</div>

</body>

<script src="bower_components/jquery/dist/jquery.js"></script>
<script src="bower_components/d3/d3.js"></script>
<script src="bower_components/mathjs/dist/math.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
<script src="bower_components/intro.js/intro.js"></script>
<!--script src="node_modules/js-regression/src/jsregression.js"></script-->
<script src="js/ml-functions.js"></script>
<script src="js/box.js"></script>
<script src="js/line_plot.js"></script>
<script src="js/event_handling.js"></script>
<script src="js/box_plot.js"></script>
<script src="js/bias-var.js"></script>
<script src="js/bar_plot.js"></script>

<script>
	var x = linspace(-7,10,17/50)
	var w = []
	var w_all = [
		[-5,50,1],
		[5, 6, 2, 3],
		[7,4,-1,10,-1]]
	var w_ind = 1
	var nf = 200 // noise factor
	var model_degree = 1
	var data = []
	var tData = [] // transformed data used in d3
	var rResult = [] //result of the regression fitting
	var rData = [] //transformed result data used in d3
	var view = 0;

	// Setup d3
	WIDTH_curve = 590
	HEIGHT_curve = 350
	var margin_curve = {top:20, right:20, bottom:30, left:80}
		width_curve = WIDTH_curve - margin.left - margin.right
		height_curve = HEIGHT_curve - margin.top - margin.bottom;

	var svg = d3.select("#plot-1").append("svg")
		.attr("width", width_curve + margin_curve.left + margin_curve.right)
		.attr("height", height_curve + margin_curve.top + margin_curve.bottom)
		.append("g")
			.attr("transform", "translate(" + margin_curve.left + "," + margin_curve.top + ")");

	var svg_data = svg.append("g").attr("class", "svg_data")
	var svg_curve = svg.append("g").attr("class", "svg_curve")
	var x_axis = svg.append("g").attr("class", "x axis")
	var y_axis = svg.append("g").attr("class", "y axis")
	var legend_main = svg.append("g").attr("class", "legend_main")
	
	var color = d3.scale.category10();;
	var color = d3.scale.ordinal()
  	.domain(["Data Points", "Regression line", "Bias", "Variance"])
  	.range(["#377eb8", "#e7298a" , "#6CC6B7", "#A8A2CD"])
	var scale_x = []
	var scale_y = []

	data = createData()
	showActualPicture()
	learnDrawCurve(1)
	learnDrawCurve(2)
	learnDrawCurve(3)
	learnDrawCurve(4)
	introJs().start();
//////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////

</script>


